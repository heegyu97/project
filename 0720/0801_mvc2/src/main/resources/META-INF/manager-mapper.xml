<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="ManagerMapper">
		
		<delete id="membermanagement_delete" parameterType="java.lang.String">
			delete from member where m_no = #{m_no}
		</delete>
		
		
		
		<select id="searchMember"  parameterType="kr.co.ictedu.util.dto.MemberDTO"
									resultType="kr.co.ictedu.util.dto.MemberDTO">
				select
						m_no, m_type, m_id, m_pwd, m_name, m_tel, m_email, m_date,
						m_service_agree, m_info_agree, m_sms_agree, m_email_agree,
						m_post, m_addr1, m_addr2, m_m
				<choose>
					<when test= "m_type == 'guest'">
						,m_cat_age, m_cat_sex, m_neut_yn
					</when>
					<when test= "m_type == 'seller'">
						,m_h_name, m_h_tel, m_h_email
					</when>
					<when test= "m_type == 'manager'">
						,m_con_key
					</when>
				</choose>
				from member
				where m_no = #{m_no}
		</select>
		
		
		<select id="selectList"  parameterType="kr.co.ictedu.util.dto.MemberDTO"
									resultType="kr.co.ictedu.util.dto.MemberDTO">
			select m_no , m_id , m_name , m_type , m_date 
			
			from member
			<if test="searchOption != null and searchOption != ''
						and searchWord != null and searchWord !=''">
				<choose>
					<when test="searchOption == 'm_type'">
						where	m_type like concat('%', #{searchWord}, '%')
					</when>
				</choose>
			</if>
			order by m_type desc
			limit #{limitNum}, 10
			
		</select>
		
		
		
		
		<select id="searchListCount" parameterType="kr.co.ictedu.util.dto.SearchDTO" resultType="int">
			select count(m_no) cnt from member
			<if test="searchOption != null and searchOption != ''
						and searchWord != null and searchWord !=''">
				<choose>
					<when test="searchOption == 'm_type'">
						where m_type like concat('%', #{searchWord}, '%')
					</when>
				</choose>
			</if>
		</select>
		
		
		<delete id="deleteid" parameterType="kr.co.ictedu.util.dto.MemberDTO">
			delete from member where m_no = #{m_no} and m_pwd = #{m_pwd}
		</delete>
		<update id="updateid" parameterType="kr.co.ictedu.util.dto.MemberDTO">
			update member set 
			m_pwd = #{m_pwd}, m_tel = #{m_tel}, m_email = #{m_email}, 
			m_sms_agree = #{m_sms_agree},m_email_agree = #{m_email_agree}, m_post = #{m_post}, 
			m_addr1 = #{m_addr1}, m_addr2 = #{m_addr2}
			where m_no = #{m_no}
		</update>
		
		<select id="list" resultType="kr.co.ictedu.util.dto.MemberDTO" >
			SELECT m_no, m_type, m_id, m_date, m_name
			FROM member
		</select>
</mapper>